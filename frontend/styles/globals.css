@tailwind base;
@tailwind components;
@tailwind utilities;

/* Dark Minimal Theme (Black shades) */
:root {
  --bg-primary: #0a0a0a; /* near-black */
  --bg-secondary: linear-gradient(180deg, #0a0a0a 0%, #0d0d0d 100%);
  --panel: rgba(255,255,255,0.03);
  --muted-panel: rgba(255,255,255,0.02);
  --glass: rgba(255,255,255,0.04);
  --text-primary: #f3f3f3;
  --text-secondary: #a8a8a8;
  --accent-1: #161616; /* neutral dark */
  --accent-2: #222222; /* neutral dark */
  --accent-glow: rgba(255,255,255,0.04);
  --border: rgba(255,255,255,0.08);
}

* { box-sizing: border-box; }
html { font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
body {
  margin: 0; padding: 0;
  background: var(--bg-primary);
  color: var(--text-primary);
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}

/* Page container */
.modern-container {
  height: 100vh; width: 100%; display: flex; flex-direction: column; align-items: stretch; justify-content: stretch; padding: 0; margin: 0;
  background: var(--bg-secondary);
}

/* New chat shell (ChatGPT/Gemini-like) */
.chat-shell { display: grid; grid-template-rows: auto 1fr auto; height: 100vh; }
.chat-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; border-bottom: 1px solid var(--border); background: var(--panel); }
.chat-nav { display: flex; gap: 12px; }
.nav-link { color: var(--text-secondary); text-decoration: none; padding: 8px 12px; border-radius: 6px; font-size: 14px; transition: all 0.2s; }
.nav-link:hover { background: var(--glass); color: var(--text-primary); }
.brand { display:flex; align-items:center; gap:10px; }
.brand__logo { width:28px; height:28px; border-radius:8px; border:1px solid var(--border); display:flex; align-items:center; justify-content:center; color: var(--text-primary) }
.brand__name { font-weight: 600; letter-spacing: .2px }
.chat-main { overflow: hidden; }
.chat-messages { height: 100%; overflow-y: auto; padding: 20px; display:flex; flex-direction: column; gap: 14px; max-width: 820px; margin: 0 auto; width: 100%; }
.chat-empty { text-align:center; padding: 24px; border:1px solid var(--border); border-radius:12px; background: var(--panel); }
.chat-empty__icon { width: 48px; height: 48px; border:1px solid var(--border); border-radius:12px; display:flex; align-items:center; justify-content:center; margin: 0 auto 10px; }
.chat-empty__title { font-weight: 600; margin-bottom: 4px }
.chat-empty__subtitle { color: var(--text-secondary); font-size: .9rem }
.message { display:flex; }
.message--user { justify-content: flex-end; }
.message--bot { justify-content: flex-start; }
.message__avatar { width: 22px; height: 22px; margin-top: 4px; margin-right: 8px; border-radius: 50%; border:1px solid var(--border); background: rgba(255,255,255,0.06); color: var(--text-primary); display:flex; align-items:center; justify-content:center; }
.message--user .message__avatar { order: 2; margin-left: 8px; margin-right: 0; background: rgba(255,255,255,0.1) }
.message__bubble { white-space: pre-wrap; line-height: 1.55; padding: 12px 14px; border-radius: 16px; max-width: 80%; border: 1px solid var(--border); }
.message--user .message__bubble { background: rgba(255,255,255,0.08) }
.message--bot .message__bubble { background: rgba(255,255,255,0.05) }
.message__actions { display:flex; align-items:center; gap:8px; margin-top: 8px; color: var(--text-secondary) }
.msg-btn { background: transparent; border:1px solid var(--border); color: var(--text-secondary); border-radius: 8px; padding: 6px; cursor: pointer }
.msg-btn.playing {
  background: rgba(0, 255, 0, 0.1);
  border-color: rgba(0, 255, 0, 0.3);
  color: #4ade80;
}

.msg-btn.playing .loading-dots {
  margin-left: 6px;
}
.markdown { white-space: pre-wrap }
.markdown code { background: rgba(255,255,255,0.08); padding: 2px 6px; border-radius: 6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace }
.markdown pre { background: rgba(255,255,255,0.06); padding: 10px 12px; border-radius: 10px; overflow: auto }
.markdown ul, .markdown ol { padding-left: 18px }
.chat-fade-top { position: sticky; top: 0; height: 24px; background: linear-gradient(180deg, rgba(10,10,10,1) 0%, rgba(10,10,10,0) 100%); pointer-events:none; }
.chat-composer { position: sticky; bottom: 0; background: linear-gradient(180deg, rgba(10,10,10,0.7), rgba(10,10,10,0.95)); border-top: 1px solid var(--border); padding: 12px 16px; backdrop-filter: blur(8px) }
.composer { max-width: 820px; margin: 0 auto; display:flex; align-items:center; gap: 8px; padding: 8px 10px; border-radius: 999px; border:1px solid var(--border); background: rgba(255,255,255,0.04) }
.composer__textarea { flex: 1; resize: none; overflow: auto; max-height: 160px; border: none; background: transparent; color: var(--text-primary); padding: 6px 6px; font: inherit; line-height: 1.4; }
.composer__textarea:focus { outline: none }
.composer__send { width: 36px; height: 36px; border-radius: 999px; border:1px solid var(--border); background: #1a1a1a; color: var(--text-primary); display:flex; align-items:center; justify-content:center; cursor:pointer }
.composer__send:disabled { opacity: 0.5; cursor: not-allowed }
.composer__stop { width: 36px; height: 36px; border-radius: 999px; border:1px solid rgba(255,0,0,0.25); background: #2a0e0e; color: #fff; display:flex; align-items:center; justify-content:center; cursor:pointer }
.composer__mic { width: 36px; height: 36px; border-radius: 999px; border:1px solid var(--border); background: #151515; color: var(--text-primary); display:flex; align-items:center; justify-content:center; cursor:pointer }
.composer__mic.is-on { background: #2a0e0e; border-color: rgba(255,0,0,0.25) }
.composer__hint { max-width: 820px; margin: 6px auto 0; color: var(--text-secondary); font-size: .78rem; text-align: center }

/* Chat panel */
.chat-wrapper {
  width: 100%; max-width: none; height: 100vh; display: flex; flex-direction: column;
  background: var(--bg-primary);
  border-radius: 0; border: none; overflow: hidden;
  box-shadow: none;
}

/* Header */
.chat-header { padding: 12px 20px; display:flex; align-items:center; justify-content:center; border-bottom:1px solid rgba(255,255,255,0.1) }
.header-left { display:flex; align-items:center; gap:12px; }
.header-content { display:flex; align-items:center; justify-content:center; gap:12px }
.chat-header .header-content { max-width: 800px; margin: 0 auto; width: 100% }
.logo-section { display:flex; align-items:center; gap:12px }
.logo { width:32px; height:32px; border-radius:8px; background: transparent; border:1px solid rgba(255,255,255,0.2); display:flex; align-items:center; justify-content:center; color:#eaeaea; font-weight:700; }
.brand-title { font-weight:600; font-size:1.1rem; color:var(--text-primary); }
.brand-sub { font-size:0.8rem; color:var(--text-secondary); }
.brand-info h1 { margin:0; font-weight:600; font-size:1.1rem; color:var(--text-primary) }
.brand-info p { margin:0; font-size:0.8rem; color:var(--text-secondary) }

.chat-body { padding: 18px; overflow-y: auto; display:flex; flex-direction:column; gap:10px; }

/* Messages (map existing class names used in lesson.tsx) */
.messages-container { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 120px; scroll-behavior: smooth }
.messages-list { display:flex; flex-direction:column; gap: 16px; }
.messages-container > .messages-list { max-width: 800px; margin: 0 auto; width: 100% }
.message-wrapper { opacity:0; transform: translateY(4px); animation: msgIn .22s ease forwards }
@keyframes msgIn { to { opacity:1; transform: translateY(0) } }

.message-bubble.tutor {
  background: rgba(255,255,255,0.05);
  color: var(--text-primary);
  border-radius: 16px; padding: 12px 16px; border: none;
  align-self: flex-start; max-width: 85%; box-shadow: none;
}

.message-bubble.user {
  background: rgba(255,255,255,0.08); color: var(--text-primary); border-radius: 16px; padding: 12px 16px; align-self: flex-end; max-width: 85%; border: none;
}

.message-content { margin-bottom: 6px; font-size:0.96rem; line-height:1.55; white-space: pre-wrap }

.provider-badge { padding: 6px 10px; background: rgba(255,255,255,0.03); border-radius:999px; font-size:0.72rem; color:var(--text-secondary); }

/* Meta row under each message */
.message-meta { display:flex; align-items:center; gap:8px; color:var(--text-secondary); font-size:0.75rem }

.audio-button { background: transparent; border:1px solid rgba(255,255,255,0.06); color:var(--text-secondary); padding:6px; border-radius:8px; cursor:pointer }
.audio-button:hover { color:var(--text-primary); border-color: rgba(255,255,255,0.2); box-shadow:0 8px 24px rgba(0,0,0,0.5); }

/* Loading Animation */
.loading-message { display:flex; justify-content:flex-start; }
.loading-bubble { background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border-radius:12px; padding:10px 14px; display:flex; align-items:center; gap:10px }
.loading-spinner { width:14px; height:14px; border-radius:50%; background: rgba(255,255,255,0.08); box-shadow: 0 0 10px rgba(0,0,0,0.2); animation: pulse 1s infinite; }
.loading-text { color:var(--text-secondary); font-size:0.9rem }

@keyframes pulse { 0% { transform: scale(0.9); opacity:0.8 } 50% { transform: scale(1); opacity:1 } 100% { transform: scale(0.9); opacity:0.8 } }

.tutor-response { display:flex; align-items:flex-start; gap:12px }
.response-text { flex:1; line-height:1.55; font-size:0.98rem; color:var(--text-primary); white-space: pre-wrap }

/* Minimal vector badge using gradient and rings */
.response-icon { width:24px; height:24px; flex-shrink:0; border-radius:6px; background: transparent; display:flex; align-items:center; justify-content:center; box-shadow:none; border:1px solid rgba(255,255,255,0.10) }
.response-icon svg { width:14px; height:14px; display:block }

/* Welcome */
.welcome-message { text-align:center; padding: 24px 16px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 12px; margin: 12px 0 }
.welcome-icon { width: 48px; height: 48px; margin: 0 auto 12px; display:flex; align-items:center; justify-content:center; border-radius: 12px; background: rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); color: var(--text-primary) }
.welcome-title { font-size: 1.1rem; font-weight: 600; margin: 0 0 6px 0; color: var(--text-primary) }
.welcome-subtitle { font-size: .9rem; color: var(--text-secondary); margin: 0 0 12px 0 }
.feature-grid { display:flex; justify-content:center; gap:8px; flex-wrap:wrap }
.feature-item { padding: 6px 10px; background: rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); border-radius: 999px; font-size: .75rem; color: var(--text-secondary) }

/* Header status and button */
.status-section { display:flex; align-items:center; gap: 8px }
.status-indicator { display:flex; align-items:center; gap:6px; padding: 6px 10px; background: rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); border-radius: 999px; color: var(--text-secondary) }
.status-dot { width:6px; height:6px; border-radius:50%; background: #2ecc71 }
.btn { padding: 8px 12px; border:1px solid rgba(255,255,255,0.08); border-radius: 10px; background: #121212; color: var(--text-primary); font-size:.85rem; cursor:pointer }
.btn:hover { background: #171717; border-color: rgba(255,255,255,0.16) }

/* Input mode toggle */
.input-mode-toggle { display:flex; justify-content:center; margin-bottom: 10px }
.mode-selector { display:flex; background: rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); border-radius: 10px; padding: 4px; gap: 6px }
.mode-button { padding: 6px 12px; background: transparent; color: var(--text-secondary); border:none; border-radius: 8px; cursor:pointer; font-size:.8rem }
.mode-button.active { background: rgba(255,255,255,0.06); color: var(--text-primary) }

/* Voice */
.voice-input-container { text-align:center }
.voice-button { width: 64px; height: 64px; border-radius: 12px; border:1px solid rgba(255,255,255,0.08); background: #151515; color: var(--text-primary); display:flex; align-items:center; justify-content:center; margin: 0 auto 12px; cursor:pointer }
.voice-button:hover { background:#1a1a1a }
.voice-button.recording { background: #2a0e0e; border-color: rgba(255,0,0,0.2) }
.voice-status { margin-bottom: 6px }
.voice-title { font-size: .95rem; font-weight: 600; margin: 0 0 4px 0; color: var(--text-primary) }
.voice-description { color: var(--text-secondary); font-size: .85rem; margin: 0 }

/* Input area */
.input-section { position: sticky; bottom: 0; padding: 16px 20px; border-top:1px solid rgba(255,255,255,0.1); background: linear-gradient(180deg, rgba(10,10,10,0.8), rgba(10,10,10,0.95)); backdrop-filter: blur(8px) }
.input-area { display:flex; gap:10px; align-items:center }
.text-input-container { background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:16px; padding:12px; display:flex; flex-direction:column; gap:10px }
.text-input { flex:1; background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); padding:12px 14px; border-radius:16px; color:var(--text-primary); transition: border-color .2s ease, box-shadow .2s ease }
.text-input:focus { border-color: rgba(255,255,255,0.2); box-shadow: 0 0 0 4px rgba(255,255,255,0.05) }
.input-footer { display:flex; align-items:center; justify-content:space-between; gap:10px }
.keyboard-hint { color: var(--text-secondary); font-size: .8rem }
.char-count { color: var(--text-secondary); font-size: .8rem }
.send-button { background: #151515; color:white; padding:12px 16px; border-radius:16px; border:1px solid rgba(255,255,255,0.1); cursor:pointer; transition: transform .08s ease, box-shadow .2s ease }
.send-button:active { transform: translateY(1px) }
.send-button:hover { background:#1e1e1e; border-color: rgba(255,255,255,0.2) }

/* Center input controls and limit width */
.input-section .text-input-container { max-width: 800px; margin: 0 auto }

/* Responsive tweaks */
@media (max-width:720px) { .chat-wrapper { height: 92vh; max-width: 100%; border-radius:10px } }

/* Message animations */
.message {
  opacity: 0;
  transform: translateY(10px);
  animation: messageSlideIn 0.3s ease-out forwards;
}

.message--user {
  animation-delay: 0.1s;
}

.message--bot {
  animation-delay: 0.05s;
}

@keyframes messageSlideIn {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Typing indicator animation */
.typing-indicator {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 12px 16px;
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.typing-dots {
  display: flex;
  gap: 2px;
}

.typing-dot {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--text-secondary);
  animation: typingBounce 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }
.typing-dot:nth-child(3) { animation-delay: 0s; }

@keyframes typingBounce {
  0%, 80%, 100% {
    transform: scale(0.8);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Smooth scrolling */
.chat-messages {
  scroll-behavior: smooth;
}

/* Composer animations */
.composer {
  transition: all 0.2s ease;
}

.composer--recording {
  border-color: rgba(255, 0, 0, 0.3);
  background: rgba(255, 0, 0, 0.05);
  animation: recordingPulse 2s infinite;
}

@keyframes recordingPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.2); }
  50% { box-shadow: 0 0 0 4px rgba(255, 0, 0, 0); }
}

/* Button hover animations */
.composer__send, .composer__stop, .composer__mic, .msg-btn {
  transition: all 0.15s ease;
}

.composer__send:hover {
  transform: scale(1.05);
  background: #2a2a2a;
}

.composer__stop:hover {
  transform: scale(1.05);
  background: rgba(255, 0, 0, 0.8);
}

.composer__mic:hover {
  transform: scale(1.05);
  background: #1a1a1a;
}

.msg-btn:hover {
  transform: scale(1.1);
}

/* Loading state animation */
.loading-dots {
  display: inline-flex;
  gap: 2px;
}

.loading-dot {
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: var(--text-secondary);
  animation: loadingPulse 1.5s infinite;
}

.loading-dot:nth-child(1) { animation-delay: 0s; }
.loading-dot:nth-child(2) { animation-delay: 0.2s; }
.loading-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes loadingPulse {
  0%, 60%, 100% {
    transform: scale(0.8);
    opacity: 0.5;
  }
  30% {
    transform: scale(1.2);
    opacity: 1;
  }
}

/* Compact composer (Gemini/ChatGPT/Claude-like) */
.text-input-container.compact {
  flex-direction: row;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.06);
}
.text-input-container.compact:focus-within { border-color: rgba(255,255,255,0.16); background: rgba(255,255,255,0.04) }
.text-input.compact {
  border: none;
  background: transparent;
  padding: 8px 10px;
  border-radius: 999px;
  resize: none;
  max-height: 120px;
  overflow-y: auto;
  line-height: 1.4;
}
.text-input.compact:focus { outline: none; box-shadow: none }
.send-icon-button {
  width: 32px; height: 32px;
  border-radius: 999px;
  display:flex; align-items:center; justify-content:center;
  background: #1a1a1a;
  border:1px solid rgba(255,255,255,0.08);
  color: var(--text-primary);
  cursor:pointer;
  transition: transform .08s ease, box-shadow .2s ease, background .2s ease;
}
.send-icon-button:hover { background: #222; border-color: rgba(255,255,255,0.16) }
.send-icon-button:active { transform: translateY(1px) }
